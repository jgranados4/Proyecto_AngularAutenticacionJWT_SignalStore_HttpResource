<form class="box" [formGroup]="formbuil">
  <div class="field">
    <label for="" class="label"> Nombre </label>
    <div class="control">
      <input
        class="input"
        formControlName="nombre"
        type="text"
        placeholder="Ingrese el Nombre"
      />
      @if(formbuil.get('nombre')?.hasError('required')){
      <p>se requiere el nombre</p>
      }
    </div>
  </div>
  <div class="field">
    <label for="" class="label"> contraseña </label>
    <div class="control">
      <input
        class="input"
        formControlName="Contrasena"
        type="password"
        placeholder="Ingrese el contraseña"
      />
      <!-- ✨ INDICADOR DE FORTALEZA CON COMPUTED SIGNAL -->
      @if(contrasenaValue()) {
      <div class="password-strength mt-2">
        <progress
          class="progress {{ passwordStrength().color }}"
          [value]="passwordStrength().percentage"
          max="100"
        ></progress>
        <p class="help {{ passwordStrength().color }}">
          Fortaleza: <strong>{{ passwordStrength().label }}</strong>
        </p>
      </div>
      }

      <!-- Errores de validación -->
      @if(shouldShowPasswordErrors()) {
      <div class="errors-container mt-2">
        <!-- Errores de frontend -->
        @if(getPasswordFrontendErrors().length > 0) {
        <ul class="help is-danger">
          @for(msg of getPasswordFrontendErrors(); track $index) {
          <li>{{ msg }}</li>
          }
        </ul>
        }

        <!-- Errores del backend -->
        @if(getPasswordBackendErrors().length > 0) {
        <ul class="help is-danger">
          <li><strong>Errores del servidor:</strong></li>
          @for(msg of getPasswordBackendErrors(); track $index) {
          <li>{{ msg }}</li>
          }
        </ul>
        }
      </div>
      }
    </div>
  </div>
  <div class="field">
    <label for="" class="label"> Email </label>
    <div class="control">
      <input
        class="input"
        formControlName="email"
        type="email"
        placeholder="Ingrese el Email"
      />
      @if(formbuil.get('email')?.hasError('required')){
      <p>se requiere el email</p>
      }
    </div>
  </div>
  <div class="field">
    <label for="" class="label">Rol</label>
    <div class="control">
      <label>
        <input type="radio" formControlName="rol" value="cliente" />
        Cliente
      </label>
      <label>
        <input type="radio" formControlName="rol" value="Administrador" />
        Administrador
      </label>
    </div>
    @if( formbuil.get('userType')?.touched &&
    formbuil.get('userType')?.hasError('required')){
    <p>se requiere el email</p>
    }
  </div>

  <div class="field">
    <p class="control">
      <button
        class="button is-success"
        (click)="registrar()"
        [disabled]="formbuil.invalid"
      >
        acceso
      </button>
    </p>
  </div>
</form>
<!-- <pre>
  {{ formbuil.value | json }}
</pre> -->
